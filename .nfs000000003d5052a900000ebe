data_name is: imagenet, data masks of: imagenet-r and val_dir is: /datasets/ImageNet/val/
Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   0%|          | 0/391 [00:00<?, ?it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   0%|          | 1/391 [00:01<09:30,  1.46s/it]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   1%|          | 2/391 [00:01<04:59,  1.30it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   2%|▏         | 6/391 [00:02<02:21,  2.72it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   2%|▏         | 7/391 [00:03<02:12,  2.89it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   3%|▎         | 11/391 [00:04<02:19,  2.73it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   4%|▍         | 16/391 [00:05<01:53,  3.29it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   5%|▌         | 21/391 [00:06<01:43,  3.58it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   6%|▌         | 22/391 [00:07<01:39,  3.71it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   7%|▋         | 26/391 [00:08<01:36,  3.78it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   7%|▋         | 27/391 [00:08<01:36,  3.79it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   8%|▊         | 31/391 [00:09<01:38,  3.65it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   8%|▊         | 32/391 [00:09<01:30,  3.95it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:   9%|▉         | 36/391 [00:10<01:36,  3.68it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  10%|█         | 41/391 [00:12<01:32,  3.78it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  12%|█▏        | 46/391 [00:13<01:31,  3.78it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  12%|█▏        | 47/391 [00:13<01:29,  3.84it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  12%|█▏        | 48/391 [00:13<01:25,  3.99it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  13%|█▎        | 51/391 [00:14<01:30,  3.76it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  13%|█▎        | 52/391 [00:15<01:30,  3.76it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  14%|█▎        | 53/391 [00:15<01:27,  3.84it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  14%|█▍        | 56/391 [00:16<01:26,  3.87it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  15%|█▍        | 57/391 [00:16<01:26,  3.85it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  15%|█▍        | 58/391 [00:16<01:21,  4.07it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  16%|█▌        | 61/391 [00:17<01:19,  4.13it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  16%|█▌        | 62/391 [00:17<01:23,  3.96it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  16%|█▌        | 63/391 [00:17<01:22,  3.96it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  17%|█▋        | 66/391 [00:18<01:16,  4.23it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  17%|█▋        | 67/391 [00:18<01:19,  4.05it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  17%|█▋        | 68/391 [00:19<01:24,  3.81it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  18%|█▊        | 71/391 [00:19<01:15,  4.27it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  18%|█▊        | 72/391 [00:19<01:14,  4.29it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  19%|█▊        | 73/391 [00:20<01:27,  3.61it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  19%|█▉        | 76/391 [00:20<01:13,  4.27it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  20%|█▉        | 77/391 [00:20<01:07,  4.68it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  20%|█▉        | 78/391 [00:21<01:28,  3.53it/s]Processing predict_imagenet_labels-imagenet-r_resnet50_01-08-2023_15-14-27:  20%|█▉        | 78/391 [00:31<02:04,  2.51it/s]
Traceback (most recent call last):
  File "/home/davidva/vscode_projects/reliableML/run_imagenet_ood_classes.py", line 173, in main
    true_class = ood_ds_specific_labels[labels[i].item()]  # e.g. labels[i].item()=0. true_class=goldfish
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/davidva/vscode_projects/reliableML/run_imagenet_ood_classes.py", line 256, in <module>
    main()
  File "/home/davidva/vscode_projects/reliableML/run_imagenet_ood_classes.py", line 175, in main
    print(f'i: {i}, labels[i].item(): {labels[i].item()}, labels.size: {labels.size}, ood_ds_specific_labels.size: {ood_ds_specific_labels.size}')
AttributeError: 'list' object has no attribute 'size'
